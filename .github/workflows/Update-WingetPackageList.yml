name: Update Winget PackageList

on:
  workflow_dispatch:
  schedule:
    - cron: "23 11 * * 1,3,5" # MO, MI, FR 12:23 MEZ (UTC+1)

permissions:
  contents: write   # notwendig f√ºr Releases

jobs:
  run-script:
    runs-on: windows-latest

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Run Update-WingetPackageList
        shell: pwsh
        run: |
          ./Update-WingetPackageList.ps1

      - name: Create or Update Release
        uses: softprops/action-gh-release@v2
        with:
          tag_name: latest
          name: Winget Package List (Auto)
          body: |
            Automatisch generierte Winget-Paketliste.
            Aktualisiert: MO / MI / FR um 12:23.
          files: |
            winget-db/AllWingetPackages.csv
          prerelease: false
          draft: false
